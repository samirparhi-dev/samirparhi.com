<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>samirparhi.com</title>
    <meta name="description" content="Blog Site of Samir Parhi">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="icon" href="https://samirparhi.com/img/brand/samirparhi-febicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Jura&family=Work+Sans&family=Comfortaa:wght@300..700&family=Raleway&family=Syne+Mono&display=swap" rel="stylesheet">
    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://samirparhi.com/styles/styles.css" />
</head>
<body class="min-h-40">
    <header class="py-5 px-5 from-sky-200 via-indigo-100 to-rose-50 bg-gradient-to-r backdrop-blur-2xl">
        <div class="flex px-5flex-nowrap items-center justify-between py-5 from-cyan-500 via-indigo-600 to-rose-400">
            <!-- Fixed-size, non-wrapping text -->
            <div class="cursor-pointer">
                <div class="px-5">
                    <ul class="flex px-2">
                        <a href="/#">
                            
                            
                            
    
                            <ul class="flex">
                                <a href="/#">
                                    
                                    
                                    
            
                                    
            
                                    <img src="https:&#x2F;&#x2F;samirparhi.com&#x2F;processed_images&#x2F;samirparhi-logo.b634d9429bb5a861.png" srcset="/img&#x2F;brand&#x2F;samirparhi-logo.png 2x"/>
                                
                                </a>
                            </ul>
                        </a>
                    </ul>
            </div>
            
            <!-- Menu that wraps below the name on smaller screens -->
            <div class="list-none px-5 mx-5 py-5 flex flex-wrap justify-center lg:justify-end space-x-5 lg:text-xl sm:text-xs md:text-sm mt-4 lg:mt-0">
                
                <li class=" hover:text-violet-900 text-fuchsia-800 font-semibold">
                    <a href="https:&#x2F;&#x2F;samirparhi.com&#x2F;#">Home</a>
                </li>
                
                <li class=" hover:text-violet-900 text-fuchsia-800 font-semibold">
                    <a href="https:&#x2F;&#x2F;samirparhi.com&#x2F;about">About</a>
                </li>
                
                <li class=" hover:text-violet-900 text-fuchsia-800 font-semibold">
                    <a href="https:&#x2F;&#x2F;samirparhi.com&#x2F;collab">Collaboration</a>
                </li>
                
                <li class=" hover:text-violet-900 text-fuchsia-800 font-semibold">
                    <a href="https:&#x2F;&#x2F;samirparhi.com&#x2F;connect">Connect</a>
                </li>
                
            </div>
        </div>
        
    </header>
    <div class="w-full h-1 bg-gradient-to-r from-purple-500 via-sky-600 to-rose-400"></div>
    


    <div class="container mx-auto py-10 flex-col-reverse  ">
      <p class="text-4xl text-center py-10 text-sky-600">
        Cross-Site Scripting (XSS) Vulnerability and Mitigation in Web Applications
      </p>

      <div class="flex container flex-wrap text-lg justify-center px-10 py-1 space-x-5 md:text-sm lg:text-xl">
        <div class="flex flex-wrap">
        <p class="text-violet-950 font-bold">Author:</p>
        <p class="text-red-800">
          <a href="/about">Samir Ranjan Parhi</a>
        </p>
        </div>
        <div class="flex flex-wrap">
        <p class="text-violet-950 font-bold">Date:</p>
        <p class="text-red-800">
          30 April 2024
        </p>
      </div>
      <div class="flex flex-wrap">
        <p class="text-violet-950 font-bold">Word Count:</p>
        <p class="text-red-800">700</p>
      </div>
      <div class="flex flex-wrap">
        <p class="text-violet-950 font-bold">Estimated Read Time:</p>
        <p class="text-red-800">4 minutes</p>
      </div>
    </div>

  </div>

    <div class=" container py-5 mx-auto rounded-lg ml-15 px-15 flex justify-between flex-wrap">

      <article class=" container text-purple-700 overflow-hidden prose mx-auto p-5 text-justify text-wrap md:text-3xl lg:text-2xl text-sm ">
        <h4 id="introduction">Introduction</h4>
<p>In the realm of web security, Cross-Site Scripting (XSS) stands as one of the most prevalent and hazardous vulnerabilities. With its ability to manipulate the interaction between a web application and its users, XSS can lead to unauthorized data exposure, session hijacking, and even malware distribution. This article delves into the concept of XSS, highlighting its potential impact and providing insight into securing applications against this threat.
Understanding Cross-Site Scripting (XSS)</p>
<p>At its core, XSS is a vulnerability that arises when a web application incorporates untrusted data into its output, allowing attackers to inject malicious scripts into the content delivered to other users. This often happens when user-generated content isn’t properly sanitized before being displayed. The impact of an XSS attack can vary, from stealing sensitive information to impersonating users or even taking control of their accounts.</p>
<h5 id="analyzing-the-vulnerable-code">Analyzing the Vulnerable Code</h5>
<p>Let’s analyze a code snippet that fetches data from an API and processes it. This sample code contains potential XSS vulnerabilities:</p>
<pre><code class="text-sm">

public String getInfofromAPI(String Authorization, String comingRequest) throws 

Exception {
        String returnOBJ = null;
        String tempResponse = null;
        RestTemplate restTemplate = new RestTemplate();
        MultiValueMap<String, String> headers = new LinkedMultiValueMap<String, String>();
        headers.add("Content-Type", "application/json");
        headers.add("AUTHORIZATION", Authorization);
        String encodedRequest = URLEncoder.encode(comingRequest, "UTF-8");
        HttpEntity<Object> request = new HttpEntity<Object>(encodedRequest, headers);
        ResponseEntity<String> response = restTemplate.exchange(requiredURL, HttpMethod.POST, request,
                String.class);
        return returnOBJ;
}
</code></pre>
<p>The key vulnerability here lies in the potential mishandling of the returnOBJ data. If the JSON response contains user-controlled data that is not properly sanitized before being processed or displayed, an attacker could inject malicious scripts.</p>
<p>Mitigating XSS Vulnerabilities</p>
<ul>
<li>Input Validation and Sanitization: Implement strict input validation and sanitize all incoming data. In the case of user-generated content, utilize output encoding functions to ensure that any data displayed on the web page is treated as plain text rather than executable code.</li>
<li>Content Security Policy (CSP): Utilize CSP headers to restrict the sources from which content can be loaded onto your web page. This can prevent the execution of scripts from unauthorized sources.</li>
<li>Contextual Output Encoding: Encode output based on its context. Different encoding methods should be used for HTML, JavaScript, and URL contexts to ensure the correct interpretation of data.</li>
<li>Use Framework Security Features: Many web frameworks offer security features to prevent XSS, such as automatic output encoding. Leverage these features to protect your application.</li>
<li>Regular Security Audits: Regularly audit your application’s codebase for potential vulnerabilities, including XSS. Automated tools and manual reviews can help identify and address security issues.</li>
</ul>
<p>Now as we understood, Let’s rewrite the above code by mitigating the XSS Vulnerabilities using the User input sanitization method.</p>
<pre><code class="text-sm">

public String getResponseFromAPI(String Authorization, String comingRequest) throws Exception {
        String returnOBJ = null;
        String tempResponse = null;
        RestTemplate restTemplate = new RestTemplate();
        MultiValueMap<String, String> headers = new LinkedMultiValueMap<String, String>();
        headers.add("Content-Type", "application/json");
        headers.add("AUTHORIZATION", Authorization);
        String encodedRequest = URLEncoder.encode(comingRequest, "UTF-8");
        HttpEntity<Object> request = new HttpEntity<Object>(encodedRequest, headers);
        ResponseEntity<String> response = restTemplate.exchange(destinationURL, HttpMethod.POST, request,
                String.class);
        tempResponse = response.getBody();
        // Desired key-value pairs and their types
        String desiredKey1 = "Name";
        Class<?> desiredValueType1 = String.class;
String desiredKey2 = "createdDate";
        Class<?> desiredValueType2 = Timestamp.class;
        // Parse the JSON response
        ObjectMapper objectMapper = new ObjectMapper();
        JsonNode jsonNode = objectMapper.readTree(tempResponse);
// Check if the desired key-value pairs exist
        if (jsonNode.has(desiredKey1) && jsonNode.has(desiredKey2)) {
            if (jsonNode.get(desiredKey1).getClass().equals(desiredValueType1)) {
                if (jsonNode.get(desiredKey2).getClass().equals(desiredValueType2)) {
                    returnOBJ = objectMapper.writeValueAsString(jsonNode);
                } else {
                    System.out.println("Value type for key2 does not match the desired type.");
                }
            } else {
                System.out.println("Value type for key1 does not match the desired type.");
            }
        } else {
            System.out.println("Desired key-value pairs not found in the JSON response.");
        }
        return returnOBJ;
}
}
</code></pre>
<p>In the above code, we have validated if the Response we got has the Appropriate key and the corresponding value is of required data type.</p>
<h4 id="conclusion">Conclusion</h4>
<p>Cross-site scripting (XSS) remains a significant threat to web applications, making them susceptible to data breaches and unauthorized access. By understanding the nature of XSS vulnerabilities and implementing proper security measures, developers can fortify their applications against these risks. Input validation, output encoding, and leveraging security features provided by frameworks are crucial steps in mitigating XSS and creating a safer online experience for users.
Happy Learning 🎉</p>

          
        </article>
        
          <div class=" flex mx-auto text-center flex-wrap p-4 justify-center">
            
            <p class="text-fuchsia-800 flex flex-wrap"> Tags 🔖 :
              
              <a href="https://samirparhi.com/tags/cyber-security/" class="text-sky-700 flex hover:underline mx-2">
                #Cyber Security 
              </a>
              
              <a href="https://samirparhi.com/tags/open-source/" class="text-sky-700 flex hover:underline mx-2">
                #Open -Source 
              </a>
              
            </p>
          </div>
          


    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
          // Select all code blocks
          const codeBlocks = document.querySelectorAll("pre");
    
          codeBlocks.forEach((block, index) => {
              // Create a copy button
              const copyButton = document.createElement("button");
              copyButton.innerText = "Copy";
              copyButton.classList.add("copy-btn", "bg-fuchsia-700", "text-white", "px-3", "py-1", "rounded-lg", "hover:bg-fuchsia-900", "absolute", "top-2", "right-2", "text-xs");
    
              // Add event listener to handle copying
              copyButton.addEventListener("click", () => {
                  const codeText = block.innerText;
                  navigator.clipboard.writeText(codeText).then(() => {
                      copyButton.innerText = "Copied!";
                      setTimeout(() => {
                          copyButton.innerText = "Copy";
                      }, 2000);
                  });
              });
    
              // Wrap the code block in a relative container and add the button
              const wrapper = document.createElement("div");
              wrapper.classList.add("relative", "code-block-wrapper", "mb-6");
              wrapper.appendChild(block.cloneNode(true));
              wrapper.appendChild(copyButton);
    
              block.replaceWith(wrapper);
          });
      });
    </script>

 


    <footer class="py-4 from-cyan-100 to-rose-50 bg-gradient-to-l backdrop-blur-md">
        <div class="px-auto flex flex-wrap justify-evenly">
            <ul class="px-5 list-none flex justify-evenly space-x-6 py-2 mx-auto rounded-xl">
                
                <li class="text-xl text-purple-700 hover:underline border-1 hover:text-indigo-600 flex rounded-lg border-fuchsia-900">
                    <a href="https:&#x2F;&#x2F;github.com&#x2F;samirparhi-dev"> GitHub</a>
                </li>
                
                <li class="text-xl text-purple-700 hover:underline border-1 hover:text-indigo-600 flex rounded-lg border-fuchsia-900">
                    <a href="https:&#x2F;&#x2F;linkedin.com&#x2F;in&#x2F;samir-parhi"> LinkedIn</a>
                </li>
                
                <li class="text-xl text-purple-700 hover:underline border-1 hover:text-indigo-600 flex rounded-lg border-fuchsia-900">
                    <a href="https:&#x2F;&#x2F;twitter.com&#x2F;samirparhi"> X</a>
                </li>
                
                <li class="text-xl text-purple-700 hover:underline border-1 hover:text-indigo-600 flex rounded-lg border-fuchsia-900">
                    <a href="mailto:samirparhi@gmail.com"> Mail</a>
                </li>
                
                <li class="text-xl text-purple-700 hover:underline border-1 hover:text-indigo-600 flex rounded-lg border-fuchsia-900">
                    <a href="https:&#x2F;&#x2F;mastodon.social&#x2F;@samirparhi"> Mastodon</a>
                </li>
                
            </ul>
        </div>
        <div class="flex py-5 text-purple-700 justify-center text-xl">
            <p>© samirparhi.com 2024</p>
        </div>
        <div class="flex py-5 text-purple-700 justify-center text-xl">
            <p>Coded 💙 by samirparhi-dev</p>
        </div>
    </footer>
</body>
</html>
